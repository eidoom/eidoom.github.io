<!DOCTYPE HTML>
<html>
	<head>
		<title>Bonding ethernet interfaces on Debian Stretch &middot; Ryan Moodie</title>
		<link rel="shortcut icon" href="//eidoom.github.io//favicon.ico">
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1" />
		<meta name="author" content="Ryan Iain Moodie">
		<meta name="description" content="Theoretical physicist">
		<meta http-equiv="content-language" content="en-gb" />

		
		<meta name="og:site_name" content="Ryan Moodie">
		<meta name="og:description" content="Theoretical physicist">
		<meta name="og:title" content="Bonding ethernet interfaces on Debian Stretch">
		<meta name="og:url" content="//eidoom.github.io/post/bonding-ethernet-interfaces-on-debian-stretch/">
		
		<meta name="og:image" content="//eidoom.github.io/images/my_avatar.jpg">
		
		

		<meta name="generator" content="Hugo 0.58.3" />

		<!--[if lte IE 8]><script src='//eidoom.github.io/js/ie/html5shiv.js'></script><![endif]-->
		<link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
		<link rel="stylesheet" href="//eidoom.github.io/academicons/css/academicons.css"/>
		<link rel="stylesheet" href="//eidoom.github.io/css/main.css" />
		<!--[if lte IE 8]><link rel="stylesheet" href="//eidoom.github.io//css/ie8.css"><![endif]-->

		
		
		<link rel="stylesheet" href="//eidoom.github.io/css/custom.css">
		
	</head>

	<body id="top">
		<!-- Header -->
<header id="header">
	<a href="//eidoom.github.io/" class="image avatar"><img src="//eidoom.github.io/images/my_avatar.jpg" alt="Ryan Moodie"></a>	
	

	
</header>




		<!-- Main -->
		<div id="main">
			
	<span>
		<h1>Bonding ethernet interfaces on Debian Stretch</h1>

		<i class="fa fa-calendar"></i>&nbsp;&nbsp;
<time datetime="2019-11-02 16:36:51 &#43;0000 UTC">02-11-2019</time>&nbsp;&nbsp;


<i class="fa fa-clock-o"></i>&nbsp;&nbsp; 2 min read&nbsp;&nbsp;



    
    
        <i class="fa fa-folder"></i>&nbsp;&nbsp;
        
        <a class="article-category-link" href="//eidoom.github.io/categories/computing">computing</a>
        
        
    



   
   
       &nbsp;&nbsp;<i class="fa fa-tags"></i>&nbsp;&nbsp;
       
       <a class="article-category-link" href="//eidoom.github.io/tags/network">network</a>
       &middot;
       
       <a class="article-category-link" href="//eidoom.github.io/tags/linux">linux</a>
       &middot;
       
       <a class="article-category-link" href="//eidoom.github.io/tags/server">server</a>
       
       
   


	</span>

	<p>
	    

<h3 id="setting-up-multiple-ethernet-interfaces-to-work-in-parallel">Setting up multiple ethernet interfaces to work in parallel</h3>

<p>Enable systemd-networkd</p>

<p><code>sudo systemctl enable systemd-networkd</code></p>

<p>Configure bond device</p>

<p><code>sudo vim /etc/systemd/network/bond1.netdev</code></p>

<pre><code>[NetDev]
Name=bond1
Description=LAG/Bond to a switch
Kind=bond

[Bond]
Mode=802.3ad
</code></pre>

<p>Add interfaces to bond</p>

<p><code>sudo vim /etc/systemd/network/bond1.network</code></p>

<pre><code>[Match]
Name=enp*

[Network]
Bond=bond1
</code></pre>

<p>Assign IP to bond</p>

<p><code>sudo vim /etc/systemd/network/dhcp.network</code></p>

<pre><code>[Match]
Name=bond1

[Network]
DHCP=yes
</code></pre>

<p>Disable previous configuration, e.g</p>

<p><code>sudo mv /etc/network/interfaces /etc/network/interfaces.backup</code></p>

<p>or</p>

<p><code>sudo apt remove connman</code></p>

<p>Apply with reboot</p>

<p><code>sudo reboot</code></p>

<p>Check</p>

<p><code>ip a</code></p>

<pre><code>1: lo: &lt;LOOPBACK,UP,LOWER_UP&gt; mtu 65536 qdisc noqueue state UNKNOWN group default qlen 1
    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00
    inet 127.0.0.1/8 scope host lo
       valid_lft forever preferred_lft forever
    inet6 ::1/128 scope host 
       valid_lft forever preferred_lft forever
2: enp3s0: &lt;BROADCAST,MULTICAST,SLAVE,UP,LOWER_UP&gt; mtu 1500 qdisc pfifo_fast master bond1 state UP group default qlen 1000
    link/ether da:0e:cb:14:25:5d brd ff:ff:ff:ff:ff:ff
    inet 192.168.1.116/24 brd 192.168.1.255 scope global enp3s0
       valid_lft forever preferred_lft forever
    inet6 fe80::d0bb:9cf3:3908:44c9/64 scope link tentative 
       valid_lft forever preferred_lft forever
3: enp0s31f6: &lt;BROADCAST,MULTICAST,SLAVE,UP,LOWER_UP&gt; mtu 1500 qdisc pfifo_fast master bond1 state UP group default qlen 1000
    link/ether da:0e:cb:14:25:5d brd ff:ff:ff:ff:ff:ff
4: bond0: &lt;NO-CARRIER,BROADCAST,MULTICAST,MASTER,UP&gt; mtu 1500 qdisc noqueue state DOWN group default qlen 1000
    link/ether 0e:bf:4a:31:39:58 brd ff:ff:ff:ff:ff:ff
5: bond1: &lt;BROADCAST,MULTICAST,MASTER,UP,LOWER_UP&gt; mtu 1500 qdisc noqueue state UP group default qlen 1000
    link/ether da:0e:cb:14:25:5d brd ff:ff:ff:ff:ff:ff
    inet 192.168.1.115/24 brd 192.168.1.255 scope global dynamic bond1
       valid_lft 84217sec preferred_lft 84217sec
</code></pre>

<p>Notice</p>

<table>
<thead>
<tr>
<th>interface</th>
<th>UP</th>
<th>SLAVE</th>
<th>MASTER</th>
<th>has IP address</th>
</tr>
</thead>

<tbody>
<tr>
<td><code>bond1</code></td>
<td>y</td>
<td>n</td>
<td>y</td>
<td>y</td>
</tr>

<tr>
<td><code>enp*</code></td>
<td>y</td>
<td>y</td>
<td>n</td>
<td>n</td>
</tr>
</tbody>
</table>

<p><a href="https://wiki.debian.org/Bonding#Using_systemd-networkd">Reference</a></p>

	</p>

	

		</div>

		<!-- Footer -->
<footer id="footer">
    <a href="//eidoom.github.io/" class="signature">
        <img src="//eidoom.github.io/images/signature_invert.png" alt="Ryan Moodie">
    </a>
    <ul class="icons">
        
            <li>
                <a href="//orcid.org/0000-0003-3493-1949" target="_blank" class="ai ai-orcid ai-2x">
                    <span class="label">ORCID</span>
                </a>
            </li>
        
        
            <li>
                <a href="//arxiv.org/a/moodie_r_1.html" target="_blank" class="ai ai-arxiv ai-2x">
                    <span class="label">arXiv</span>
                </a>
            </li>
        
        
            <li>
                <a href="//github.com/eidoom" target="_blank" class="icon fa-github fa-lg">
                    <span class="label">GitHub</span>
                </a>
            </li>
        
        
            <li>
                <a href="//gitlab.com/eidoom" target="_blank" class="icon fa-gitlab fa-lg">
                    <span class="label">GitLab</span>
                </a>
            </li>
        
        
            <li>
                <a href="//bitbucket.com/ryanmoodie" target="_blank" class="icon fa-bitbucket fa-lg">
                    <span class="label">BitBucket</span>
                </a>
            </li>
        
        
            <li>
                <a href="mailto:ryan.i.moodie@durham.ac.uk" class="icon fa-envelope fa-lg">
                    <span class="label">Email</span>
                </a>
            </li>
        
    </ul>
    <ul class="copyright">
        
        <li>Design: <a href="//themes.gohugo.io/strata/">Strata</a></li>
        
        <li>Pictures: <a href="//www.yazashmawi.com/">Yaz Ashmawi</a></li>
        
	<li><a rel="license" class="icon"  href="http://creativecommons.org/licenses/by-sa/4.0/"><img alt="Creative Commons Licence" style="border-width:0" src="https://i.creativecommons.org/l/by-sa/4.0/80x15.png" /></a></li>
    </ul>
</footer>

<!-- Scripts -->
<script src="//eidoom.github.io/js/jquery.min.js"></script>
<script src="//eidoom.github.io/js/jquery.poptrox.min.js"></script>
<script src="//eidoom.github.io/js/skel.min.js"></script>
<script src="//eidoom.github.io/js/util.js"></script>

<script src="//eidoom.github.io/js/main.js"></script>


<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-66224969-2', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>




	</body>
</html>
